<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Мой аккаунт | AgroPartem</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <!-- Навбар (аналогичный главной) -->
    <nav class="navbar navbar-expand-lg">
      <div class="container">
        <a class="navbar-brand" href="index.html">AgroPartem</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Главная</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="about.html">О нас</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="services.html">Услуги</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="contacts.html">Контакты</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="account.html">Аккаунт</a>
            </li>
          </ul>
          <div class="d-flex">
            <button id="themeToggle" class="btn btn-outline-secondary me-2">
              <i id="themeIcon" class="bi bi-sun"></i>
            </button>
            <button id="logoutButton" class="btn btn-outline">Выход</button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Основное содержимое -->
    <main class="container my-5">
      <div class="p-5 mb-4 rounded-3 border border-secondary account-with-bg">
        <div class="container-fluid py-5">
          <div class="row">
            <!-- Левая колонка - меню (20% ширины) -->
            <div class="col-md-4 col-lg-3">
              <div
                class="d-flex flex-column flex-shrink-0 p-3 rounded bg-account-menu"
              >
                <ul class="nav nav-pills flex-column mb-auto">
                  <li class="nav-item">
                    <button
                      class="nav-link active tab-button"
                      data-tab="profile"
                    >
                      <i class="bi bi-person me-2"></i>Профиль
                    </button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link tab-button" data-tab="settings">
                      <i class="bi bi-gear me-2"></i>Настройки
                    </button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link tab-button" data-tab="devices">
                      <i class="bi bi-cpu me-2"></i>Устройства
                    </button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link tab-button" data-tab="gps">
                      <i class="bi bi-geo-alt me-2"></i>Отслеживание
                    </button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link tab-button" data-tab="stats">
                      <i class="bi bi-shield-lock me-2"></i>Статистика
                    </button>
                  </li>
                  <li class="nav-item">
                    <button class="nav-link tab-button" data-tab="help">
                      <i class="bi bi-question-circle me-2"></i>Помощь
                    </button>
                  </li>
                </ul>
              </div>
            </div>

            <!-- Правая колонка - контент (80% ширины) -->
            <div class="col-md-8 col-lg-9 rounded bg-opacity-item">
              <!-- Контент вкладок -->
              <div id="profile" class="tab-content py-3 active">
                <h2>Мой профиль</h2>
                <p>Здесь будет информация о профиле...</p>
                <!-- Бла Бла Бла -->
              </div>

              <div id="settings" class="tab-content py-3">
                <h2>Настройки аккаунта</h2>
                <p>Здесь будут настройки аккаунта...</p>
                <!-- Бла Бла Бла -->
              </div>

              <div id="devices" class="tab-content py-3">
                <h2>Список устройств</h2>
                <p>Загружаем список устройств...</p>
                <!-- Бла Бла Бла -->
              </div>

              <div id="gps" class="tab-content py-3">
                <h2>Отслеживание устройств</h2>
                <div
                  id="mapContainer"
                  style="height: 500px; border-radius: 8px; margin-top: 15px"
                >
                  <div id="trackingMap" style="height: 100%"></div>
                </div>
                <div class="mt-3">
                  <button id="centerMapBtn" class="btn btn-sm btn-primary">
                    Центрировать карту
                  </button>
                  <button id="addMarkerBtn" class="btn btn-sm btn-success ms-2">
                    Добавить тестовый маркер
                  </button>
                </div>
              </div>

              <div id="stats" class="tab-content py-3">
                <h2>Статистика</h2>
                <p>Здесь будет статистика по аккаунту...</p>
                <!-- Бла Бла Бла -->
              </div>

              <div id="help" class="tab-content py-3">
                <h2>Помощь</h2>
                <p>Здесь будет FAQ и форма обращения в поддержку...</p>
                <!-- Бла Бла Бла -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Подвал -->
    <footer class="footer mt-auto py-3 border-top border-secondary">
      <div class="container">
        <span>© 2025 AgroPartem</span>
      </div>
    </footer>

    <!------------------------- Шаблоны --------------------------->

    <!-- Шаблон списка устройств -->
    <template id="devicesTemplate">
      <h2><i class="bi bi-devices"></i> Список устройств</h2>
      <div class="devices-list mt-3">
        <!-- Сюда будет вставляться список -->
      </div>
    </template>

    <!-- Шаблон конкретного устройства -->
    <template id="deviceItemTemplate">
      <div class="device-item p-3 border-bottom">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h5 class="mb-1 device-name"></h5>
            <small class="text-muted device-serial"></small>
          </div>
          <i class="bi bi-chevron-right"></i>
        </div>
      </div>
    </template>

    <!-- Шаблон модального окна устройства -->
    <template id="deviceModalTemplate">
      <div class="modal fade" id="deviceModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Редактирование устройства</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
              ></button>
            </div>
            <div class="modal-body">
              <form id="deviceForm">
                <div class="mb-3">
                  <label class="form-label">Название</label>
                  <input
                    type="text"
                    class="form-control"
                    id="deviceNameInput"
                    required
                  />
                </div>

                <div class="mb-3">
                  <label class="form-label">Серийный номер</label>
                  <input
                    type="text"
                    class="form-control"
                    id="deviceSerialInput"
                    readonly
                  />
                </div>

                <div class="mb-3">
                  <label class="form-label">Последняя активность</label>
                  <input
                    type="text"
                    class="form-control"
                    id="deviceLastActiveInput"
                    readonly
                  />
                </div>

                <div class="mb-4">
                  <label class="form-label">GPS-треки</label>
                  <div id="deviceTracksList" class="list-group">
                    <!-- Треки будут добавляться динамически -->
                  </div>
                </div>

                <div class="text-end mb-3">
                  <button
                    type="button"
                    class="btn btn-sm btn-outline-danger"
                    id="deleteDeviceBtn"
                  >
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Отмена
              </button>
              <button type="button" class="btn btn-primary" id="saveDeviceBtn">
                Сохранить изменения
              </button>
            </div>
          </div>
        </div>
      </div>
    </template>

    <!-- Шаблон элемента трека -->
    <template id="trackItemTemplate">
      <a
        href="#"
        class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
      >
        <div class="track-self">
          <h6 class="mb-1 track-date">2023-05-15 14:30</h6>
          <small class="text-muted track-coords">55.7558° N, 37.6173° E</small>
        </div>
        <i class="bi bi-arrow-right-circle"></i>
      </a>
    </template>

    <!-- Модальное окно привязки устройства -->
    <div
      class="modal fade"
      id="deviceBindModal"
      tabindex="-1"
      aria-labelledby="deviceBindModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deviceBindModalLabel">
              Привязка устройства
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="bindModalContent">
            <!-- Здесь будут рендериться компоненты -->
          </div>
        </div>
      </div>
    </div>

    <!-- Шаблоны компонентов -->
    <template id="serialNumberComponent">
      <div class="bind-component">
        <p class="mb-3">Введите серийный номер устройства</p>
        <div class="input-group mb-3">
          <input
            type="text"
            class="form-control"
            id="serialNumberInput"
            placeholder="Серийный номер"
          />
        </div>
        <button type="button" class="btn btn-primary w-100" id="bindDeviceBtn">
          Привязать
        </button>
      </div>
    </template>

    <template id="verificationCodeComponent">
      <div class="bind-component">
        <p class="mb-3">Введите код с устройства</p>
        <div class="input-group mb-3">
          <input
            type="text"
            class="form-control"
            id="verificationCodeInput"
            placeholder="Код подтверждения"
          />
        </div>
        <button type="button" class="btn btn-primary w-100" id="submitCodeBtn">
          Отправить
        </button>
      </div>
    </template>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script type="module" src="js/account.js"></script>
  </body>
</html>
